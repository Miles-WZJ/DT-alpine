# 計算六都兒童口罩各數


##Pig
-----------------------------------

```python
data = load '/user/user01/01-04-2020-18-14.csv' using PigStorage(',')as(code:chararray,name:chararray,address:chararray,phone:chararray,adult:int,kid:int,time:chararray);
f = filter data by $2 MATCHES '(臺北市|新北市|桃園市|臺中市|臺南市|高雄市).*';
g = foreach f generate SUBSTRING($2,0,3),$5;
h = group g by $0;
i = foreach h generate $0,SUM(g.kid);
dump i;
```
-------------------------------------

* 一人連線所花費時間

| 計算六都兒童口罩各數 | 1 | 2 | 3 | 4 | 5 | 平均 |
| ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- |
| Tez | 55.389s | 55.272s | 57.463s | 56.322s | 55.189s | 55.927s |

* 十人連線所花費時間

| 計算六都兒童口罩各數 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 平均 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| Tez | 150.674s | 156.319s | 157.022s | 160.242s | 202.726s | 206.308s | 206.311s | 207.956s | 251.695s | 251.519s | 195.0772s |

-------------------------------------

##Hive
-----------------------------------

```python
SELECT col1,col2 FROM 
(SELECT SUBSTR(address,1,3) AS col1 ,SUM(kid) AS col2 FROM mask01 GROUP BY SUBSTR(address,1,3))
 AS step1 WHERE col1 LIKE '臺北市%' or col1 like'新北市%' or col1 like'桃園市%' or col1 like'臺中市%' or col1 like'臺南市%' or col1 like'高雄市%';
```
-------------------------------------

* 一人連線所花費時間

| 計算六都兒童口罩各數 | 1 | 2 | 3 | 4 | 5 | 平均 |
| ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- |
| Tez | 86.958s | 88.561s | 87.563s | 86.988s | 87.114s | 87.4368s |

* 十人連線所花費時間

| 計算六都兒童口罩各數 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 平均 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| Tez | 336.376s | 338.423s | 340.071s | 341.314s | 341.660s | 341.900s | 342.602s | 341.744s | 363.369s | 365.823s | 345.3282s |
